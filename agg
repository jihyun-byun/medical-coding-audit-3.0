SELECT
  nd.appointment_id,
  nd.appointment_date,
  nd.nth_note,
  nd.doctor_id,
  nd.group_id,
  ext.extractor_id,
  po.doctor_name,
  po.group_name,
  em.em_code,
  bhr.work_email,
  assign.auditor
FROM
  {{note_data.data}} AS nd
  LEFT JOIN {{extractors.data}} AS ext ON (ext.appointment_id = nd.appointment_id)
  LEFT JOIN {{provs_and_orgs.data}} AS po ON (po.doctor_id = nd.doctor_id)
  LEFT JOIN {{em_codes.data}} AS em ON (em.id = nd.appointment_id)
  LEFT JOIN {{bhr.data}} AS bhr ON (bhr.scribe_id = ext.extractor_id)
  LEFT JOIN {{assignments.data}} AS assign ON (assign.group_id = nd.group_id)
WHERE
  ext.extractor_id IS NOT NULL
ORDER BY
  nd.appointment_id DESC